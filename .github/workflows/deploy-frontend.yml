# Acci√≥n para desplegar el c√≥digo del frontend a Heroku
# TUTORIAL: https://medium.com/swlh/auto-deploying-a-monorepo-to-heroku-with-github-actions-da62e8ae172c

name: Desplegar frontend a Heroku
on:
  # Ejecutar cuando se haga push a _main_ y hayan sido modificados ficheros del frontend
  push:
    branches:
      - main
    paths:
      - "frontend-tfg/**"
      - ".github/workflows/deploy-frontend.yml"
jobs:
  # Desplegar c√≥digo
  deploy:
    name: Deploy frontend to Heroku repository
    runs-on: ubuntu-20.04
    steps:
      # Clonar repositorio en m√°quina remota
      - name: üëç Checkout code
        uses: actions/checkout@v3
        with:
          fetch-depth: 0

      # A√±adir remoto de heroku al repositorio
      - name: ‚ûï Add Heroku remote repository for backend
        run: git remote add heroku-frontend https://heroku:${{ secrets.HEROKU_FRONTEND_API_KEY }}@git.heroku.com/${{ secrets.HEROKU_FRONTEND_APP_NAME }}.git

      # Pushear c√≥digo al remoto de heroku para despliegue autom√°tico
      - name: üöÄ Deploy frontend to Heroku
        run: git push heroku-frontend `git subtree split --prefix frontend-tfg main`:refs/heads/master --force
